{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.HintCallout = void 0;\n\nvar react_client_1 = require(\"@speechly/react-client\");\n\nvar react_1 = __importStar(require(\"react\"));\n\nvar types_1 = require(\"../types\");\n\nvar Callout_1 = require(\"./Callout\");\n\nvar HintCallout = function (props) {\n  var _a = react_1.useState(false),\n      visible = _a[0],\n      setVisible = _a[1];\n\n  var timeout = react_1.useRef(null);\n  var SHORT_PRESS_TRESHOLD_MS = 600;\n  var INSTRUCTION_PREROLL_MS = 500;\n  var INSTRUCTION_SHOW_TIME_MS = 3000;\n  react_1.useEffect(function () {\n    var subTangentPress = PubSub.subscribe(types_1.SpeechlyUiEvents.TangentPress, function (message, payload) {\n      // console.log('TangentPress', payload.state)\n      hideHints();\n    });\n    var subTangentClick = PubSub.subscribe(types_1.SpeechlyUiEvents.TangentRelease, function (message, payload) {\n      // console.log('TangentRelease ', payload.state, payload.timeMs)\n      // Detect short record button presses\n      if (payload.timeMs < SHORT_PRESS_TRESHOLD_MS) {\n        switch (payload.state) {\n          case react_client_1.SpeechState.Ready:\n          case react_client_1.SpeechState.Recording:\n          case react_client_1.SpeechState.Loading:\n            if (timeout.current === null) {\n              timeout.current = window.setTimeout(function () {\n                setVisible(true);\n                timeout.current = window.setTimeout(function () {\n                  setVisible(false);\n                  timeout.current = null;\n                }, INSTRUCTION_SHOW_TIME_MS);\n              }, INSTRUCTION_PREROLL_MS);\n            }\n\n        }\n      }\n    });\n    return function () {\n      PubSub.unsubscribe(subTangentPress);\n      PubSub.unsubscribe(subTangentClick);\n    };\n  }, []);\n\n  var hideHints = function () {\n    setVisible(false);\n\n    if (timeout.current !== null) {\n      clearTimeout(timeout.current);\n      timeout.current = null;\n    }\n  };\n\n  return react_1.default.createElement(Callout_1.Callout, {\n    sourceAnchors: {\n      x: '50%',\n      y: '6%'\n    },\n    visible: visible,\n    onClick: function () {\n      return hideHints();\n    }\n  }, \"Hold to talk\");\n};\n\nexports.HintCallout = HintCallout;","map":{"version":3,"sources":["../../src/components/HintCallout.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAA,cAAA,GAAA,OAAA,CAAA,wBAAA,CAAA;;AACA,IAAA,OAAA,GAAA,YAAA,CAAA,OAAA,CAAA,OAAA,CAAA,CAAA;;AACA,IAAA,OAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AACA,IAAA,SAAA,GAAA,OAAA,CAAA,WAAA,CAAA;;AAEO,IAAM,WAAW,GAAa,UAAA,KAAA,EAAK;AAClC,MAAA,EAAA,GAAwB,OAAA,CAAA,QAAA,CAAkB,KAAlB,CAAxB;AAAA,MAAC,OAAO,GAAA,EAAA,CAAA,CAAA,CAAR;AAAA,MAAU,UAAU,GAAA,EAAA,CAAA,CAAA,CAApB;;AACN,MAAM,OAAO,GAAG,OAAA,CAAA,MAAA,CAAsB,IAAtB,CAAhB;AAEA,MAAM,uBAAuB,GAAG,GAAhC;AACA,MAAM,sBAAsB,GAAG,GAA/B;AACA,MAAM,wBAAwB,GAAG,IAAjC;AAEA,EAAA,OAAA,CAAA,SAAA,CAAU,YAAA;AACR,QAAM,eAAe,GAAG,MAAM,CAAC,SAAP,CACtB,OAAA,CAAA,gBAAA,CAAiB,YADK,EAEtB,UAAC,OAAD,EAAkB,OAAlB,EAAiD;AAC/C;AACA,MAAA,SAAS;AACV,KALqB,CAAxB;AAOA,QAAM,eAAe,GAAG,MAAM,CAAC,SAAP,CACtB,OAAA,CAAA,gBAAA,CAAiB,cADK,EAEtB,UAAC,OAAD,EAAkB,OAAlB,EAAiE;AAC/D;AACA;AACA,UAAI,OAAO,CAAC,MAAR,GAAiB,uBAArB,EAA8C;AAC5C,gBAAQ,OAAO,CAAC,KAAhB;AACE,eAAK,cAAA,CAAA,WAAA,CAAY,KAAjB;AACA,eAAK,cAAA,CAAA,WAAA,CAAY,SAAjB;AACA,eAAK,cAAA,CAAA,WAAA,CAAY,OAAjB;AACE,gBAAI,OAAO,CAAC,OAAR,KAAoB,IAAxB,EAA8B;AAC5B,cAAA,OAAO,CAAC,OAAR,GAAkB,MAAM,CAAC,UAAP,CAAkB,YAAA;AAClC,gBAAA,UAAU,CAAC,IAAD,CAAV;AACA,gBAAA,OAAO,CAAC,OAAR,GAAkB,MAAM,CAAC,UAAP,CAAkB,YAAA;AAClC,kBAAA,UAAU,CAAC,KAAD,CAAV;AACA,kBAAA,OAAO,CAAC,OAAR,GAAkB,IAAlB;AACD,iBAHiB,EAGf,wBAHe,CAAlB;AAID,eANiB,EAMf,sBANe,CAAlB;AAOD;;AAZL;AAcD;AACF,KArBqB,CAAxB;AAuBA,WAAO,YAAA;AACL,MAAA,MAAM,CAAC,WAAP,CAAmB,eAAnB;AACA,MAAA,MAAM,CAAC,WAAP,CAAmB,eAAnB;AACD,KAHD;AAID,GAnCD,EAmCG,EAnCH;;AAqCA,MAAM,SAAS,GAAG,YAAA;AAChB,IAAA,UAAU,CAAC,KAAD,CAAV;;AACA,QAAI,OAAO,CAAC,OAAR,KAAoB,IAAxB,EAA8B;AAC5B,MAAA,YAAY,CAAC,OAAO,CAAC,OAAT,CAAZ;AACA,MAAA,OAAO,CAAC,OAAR,GAAkB,IAAlB;AACD;AACF,GAND;;AAQA,SAAO,OAAA,CAAA,OAAA,CAAA,aAAA,CAAC,SAAA,CAAA,OAAD,EAAQ;AAAC,IAAA,aAAa,EAAE;AAAE,MAAA,CAAC,EAAE,KAAL;AAAY,MAAA,CAAC,EAAE;AAAf,KAAhB;AAAuC,IAAA,OAAO,EAAE,OAAhD;AAAyD,IAAA,OAAO,EAAE,YAAA;AAAM,aAAA,SAAA,EAAA;AAAW;AAAnF,GAAR,EAA2F,cAA3F,CAAP;AACD,CAtDM;;AAAM,OAAA,CAAA,WAAA,GAAW,WAAX","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HintCallout = void 0;\nvar react_client_1 = require(\"@speechly/react-client\");\nvar react_1 = __importStar(require(\"react\"));\nvar types_1 = require(\"../types\");\nvar Callout_1 = require(\"./Callout\");\nvar HintCallout = function (props) {\n    var _a = react_1.useState(false), visible = _a[0], setVisible = _a[1];\n    var timeout = react_1.useRef(null);\n    var SHORT_PRESS_TRESHOLD_MS = 600;\n    var INSTRUCTION_PREROLL_MS = 500;\n    var INSTRUCTION_SHOW_TIME_MS = 3000;\n    react_1.useEffect(function () {\n        var subTangentPress = PubSub.subscribe(types_1.SpeechlyUiEvents.TangentPress, function (message, payload) {\n            // console.log('TangentPress', payload.state)\n            hideHints();\n        });\n        var subTangentClick = PubSub.subscribe(types_1.SpeechlyUiEvents.TangentRelease, function (message, payload) {\n            // console.log('TangentRelease ', payload.state, payload.timeMs)\n            // Detect short record button presses\n            if (payload.timeMs < SHORT_PRESS_TRESHOLD_MS) {\n                switch (payload.state) {\n                    case react_client_1.SpeechState.Ready:\n                    case react_client_1.SpeechState.Recording:\n                    case react_client_1.SpeechState.Loading:\n                        if (timeout.current === null) {\n                            timeout.current = window.setTimeout(function () {\n                                setVisible(true);\n                                timeout.current = window.setTimeout(function () {\n                                    setVisible(false);\n                                    timeout.current = null;\n                                }, INSTRUCTION_SHOW_TIME_MS);\n                            }, INSTRUCTION_PREROLL_MS);\n                        }\n                }\n            }\n        });\n        return function () {\n            PubSub.unsubscribe(subTangentPress);\n            PubSub.unsubscribe(subTangentClick);\n        };\n    }, []);\n    var hideHints = function () {\n        setVisible(false);\n        if (timeout.current !== null) {\n            clearTimeout(timeout.current);\n            timeout.current = null;\n        }\n    };\n    return react_1.default.createElement(Callout_1.Callout, { sourceAnchors: { x: '50%', y: '6%' }, visible: visible, onClick: function () { return hideHints(); } }, \"Hold to talk\");\n};\nexports.HintCallout = HintCallout;\n//# sourceMappingURL=HintCallout.js.map"]},"metadata":{},"sourceType":"script"}